{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "Victory Command Prototype Schema",
  "description": "Minimal schema for reconstructed systems.",
  "type": "object",
  "properties": {
    "cities": {
      "type": "array",
      "items": { "$ref": "#/definitions/City" }
    }
  },
  "required": ["cities"],
  "definitions": {
    "ResourceSet": {
      "type": "object",
      "properties": {
        "resourceType": { "type": "string", "enum": ["Food", "Steel", "Oil", "RareMetal", "Gold", "DarkEnergy"] },
        "stored": { "type": "integer", "minimum": 0 },
        "capacity": { "type": "integer", "minimum": 0 }
      },
      "required": ["resourceType", "stored", "capacity"]
    },
    "ProductionField": {
      "type": "object",
      "properties": {
        "resourceType": { "type": "string" },
        "fields": { "type": "integer", "minimum": 0 },
        "outputPerField": { "type": "integer", "minimum": 0 }
      },
      "required": ["resourceType", "fields", "outputPerField"]
    },
    "Wall": {
      "type": "object",
      "properties": {
        "maxHp": { "type": "integer", "minimum": 1 },
        "currentHp": { "type": "integer", "minimum": 0 },
        "fortificationPoints": { "type": "integer", "minimum": 0 }
      },
      "required": ["maxHp", "currentHp", "fortificationPoints"]
    },
    "BuildOrder": {
      "type": "object",
      "properties": {
        "buildingType": { "type": "string" },
        "targetLevel": { "type": "integer", "minimum": 1 },
        "secondsRemaining": { "type": "integer", "minimum": 0 }
      },
      "required": ["buildingType", "targetLevel", "secondsRemaining"]
    },
    "BuildQueue": {
      "type": "object",
      "properties": {
        "baseSlots": { "type": "integer", "minimum": 1 },
        "blueprintTokens": { "type": "integer", "minimum": 0 },
        "orders": { "type": "array", "items": { "$ref": "#/definitions/BuildOrder" } }
      },
      "required": ["baseSlots", "blueprintTokens", "orders"]
    },
    "TrainingCost": {
      "type": "object",
      "properties": {
        "resourceType": { "type": "string" },
        "amount": { "type": "integer", "minimum": 0 }
      },
      "required": ["resourceType", "amount"]
    },
    "TrainingQueue": {
      "type": "object",
      "properties": {
        "unitType": { "type": "string" },
        "quantity": { "type": "integer", "minimum": 0 },
        "durationSeconds": { "type": "integer", "minimum": 1 },
        "upkeepFoodPerTick": { "type": "integer", "minimum": 0 },
        "costs": { "type": "array", "items": { "$ref": "#/definitions/TrainingCost" } }
      },
      "required": ["unitType", "quantity", "durationSeconds", "costs"]
    },
    "TransportRoute": {
      "type": "object",
      "properties": {
        "targetCityId": { "type": "string" },
        "resourceType": { "type": "string" },
        "amountPerShipment": { "type": "integer", "minimum": 0 },
        "intervalSeconds": { "type": "integer", "minimum": 1 },
        "secondsUntilNext": { "type": "integer", "minimum": 0 }
      },
      "required": ["targetCityId", "resourceType", "amountPerShipment", "intervalSeconds"]
    },
    "Officer": {
      "type": "object",
      "properties": {
        "id": { "type": "string" },
        "name": { "type": "string" },
        "politics": { "type": "integer", "minimum": 0 },
        "military": { "type": "integer", "minimum": 0 },
        "knowledge": { "type": "integer", "minimum": 0 }
      }
    },
    "City": {
      "type": "object",
      "properties": {
        "id": { "type": "string" },
        "displayName": { "type": "string" },
        "morale": { "type": "number", "minimum": 0, "maximum": 1 },
        "wall": { "$ref": "#/definitions/Wall" },
        "buildQueue": { "$ref": "#/definitions/BuildQueue" },
        "resources": { "type": "array", "items": { "$ref": "#/definitions/ResourceSet" } },
        "production": { "type": "array", "items": { "$ref": "#/definitions/ProductionField" } },
        "trainingQueues": { "type": "array", "items": { "$ref": "#/definitions/TrainingQueue" } },
        "transportRoutes": { "type": "array", "items": { "$ref": "#/definitions/TransportRoute" } },
        "officers": { "type": "array", "items": { "$ref": "#/definitions/Officer" } }
      },
      "required": ["id", "displayName", "morale", "wall", "buildQueue", "resources", "production"]
    }
  }
}
